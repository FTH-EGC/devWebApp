public void spSummon(string spName, string[] spParameters)
        {
            using (SqlConnection cn = new SqlConnection(s_connection)) 
            {
                try
                {
                    SqlCommand cmd = new SqlCommand(spName, cn);
                    cmd.CommandType = CommandType.StoredProcedure;

                    for (int i = 0; i <= spParameters.Count() - 1; i++)
                    {
                        String[] substrings = spParameters[i].Split(':');
                        cmd.Parameters.AddWithValue(substrings[0], substrings[1]);
                    }

                    cmd.CommandTimeout = 0;
                    cn.Open();
                    cmd.ExecuteNonQuery();
                }
                catch (Exception e) 
                {
                    throw (e);
                }

            }
        }
public DataTable spGetData(string spName, string[] spParameters)
        {

            using (SqlConnection cn = new SqlConnection(ConfigurationManager.ConnectionStrings["Global"].ConnectionString))
            {
                cn.Open();
                DataTable dt = new DataTable();

                SqlCommand cmd = new SqlCommand(spName, cn);
                cmd.CommandType = CommandType.StoredProcedure;

                for (int i = 0; i <= spParameters.Count() - 1; i++)
                {
                    String[] substrings = spParameters[i].Split(':');
                    cmd.Parameters.AddWithValue(substrings[0], substrings[1]);
                }

                cmd.ExecuteNonQuery();
                SqlDataAdapter da = new SqlDataAdapter(cmd);
                da.Fill(dt);

                if (dt.Rows.Count > 0)
                {
                    //for (int i = 0; i < rows.Length; i++)
                    //{
                    //    Console.WriteLine(rows[i]["Order_Back"]);
                    //}

                    returnedDt = dt;
                }
                //else
                //{

                //}
            }
            return returnedDt;
        }
